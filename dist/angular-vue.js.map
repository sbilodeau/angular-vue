{"version":3,"file":"angular-vue.js","sources":["../src/libs/paths.js","../src/directives/vue.js","../src/index.js"],"sourcesContent":["export default {\n    parent,\n    parents,\n    leaf,\n    root,\n    isRoot\n};\n\nfunction parent(path) {\n    const parts = split(path)\n\n    parts.pop();\n\n    return combine(parts)\n}\n\nfunction parents(path) {\n    const parentPaths = [];\n\n    path = parent(path)\n\n    while(path) {\n        parentPaths.push(path);\n        path = parent(path)\n    }\n\n    return parentPaths;\n}\n\nfunction leaf(path) {\n    const parts = split(path);\n    return parts.pop();\n}\n\nfunction root(path) {\n    return split(path)[0];\n}\n\nfunction isRoot(path) {\n    return split(path).length==1;\n}\n\nfunction split(path) {\n\n    if(!path) throw new Error(`Invalid path ${path}`);\n\n    return path.split('.');\n}\n\nfunction combine(parts) {\n    return parts.join('.');\n}\n\n\n\n\n","import _ from \"lodash\"\nimport Vue from \"Vue\"\nimport paths from \"../libs/paths\"\n\nexport default { register };\n\nfunction register(ngModule) { ngModule.directive('vue', [function() {\n    return {\n        restrict: 'A',\n        terminal: true,//any directive with lower priority will be ignored\n        priority: 1001,// 1 more than ngNonBindable => disable angular interpolation!\n        link: function(scope, element, attrs) {\n\n            const ngDelegates             = loadExposedDelegates (attrs)\n            const ngProperties            = loadExposedProperties(attrs)\n            const syncedPropertiesMapping = loadSyncedPropertiesMapping(attrs)\n\n            // test declarations\n\n            ngProperties.forEach((prop) => testDefined(scope, prop));\n            ngDelegates .forEach((prop) => testDefined(scope, prop));\n\n            const vueData = ngProperties.filter(paths.isRoot).reduce((data, ngProp) => {\n                const vueProp = ngProp;\n                data[vueProp] = scope.$eval(ngProp); // set initial value\n                return data\n            }, {});\n\n            const vueMethods = ngDelegates.reduce((methods, ngDelegate) => {\n                methods[ngDelegate] = function() { \n                    console.log(`Calling ng delegate: ${ngDelegate}()`)\n                    scope.$apply(()=>scope.$eval(ngDelegate).apply(scope, arguments));\n                }\n                return methods\n            }, {});\n\n            //Create root component;\n\n            var vm = new Vue({\n                components : scope.$vueComponents,\n                data: vueData,\n                methods : vueMethods,\n            }).$mount(element[0]);\n\n            // Watch changes \n\n            for(const prop of ngProperties) {\n\n                const ngProp  = prop\n                const vueProp = prop;\n\n                scope.$watch(ngProp, function(value) { \n                    console.log(`ng(${ngProp}) => vue(${vueProp}) =`, value);\n\n                    let target = vm;\n                    let prop   = vueProp;\n\n                    if(!paths.isRoot(prop)) {\n                        target = _.get(vm, paths.parent(prop));\n                        prop   = paths.leaf(prop);\n                    }\n\n                    Vue.set(target, prop, value); \n                });\n            }\n\n            for(const vueProp in syncedPropertiesMapping) { // .sync\n                const ngProp = syncedPropertiesMapping[vueProp];\n\n                vm.$children.forEach(c=>c.$on(`update:${vueProp}`, (value) => {\n                    console.log(`vue(${vueProp}) => ng(${ngProp}) =`, value);\n                    scope.$apply(()=>_.set(scope, ngProp, value));\n                }));\n            }\n        }\n    };\n\n    function loadExposedProperties(attrs) {\n\n        const vDirectives = /^(?:v-model|v-html|v-text|v-show|v-class|v-attr|v-style|v-if)(?:\\.[a-z0-9]+)*$/i;\n        const vBind       = /^(?:v-bind)?:[a-z\\-]+(\\.[a-z]+)*$/i;\n        const vBindValue  = /^[a-z\\$_][a-z0-9\\$_]*(\\.[a-z\\$_][a-z0-9\\$_]*)*$/i;\n\n        let properties = (attrs.vueExpose??\"\").split(',').map(o => o.trim()).filter(o => vBindValue.test(o) );\n\n        // autodetect simple binding on props detect \n\n        const attributes = remapAttributes(attrs);\n\n        for(const name in attributes) {\n            const value = attributes[name];\n\n            const validName =  vBind      .test(name)\n                            || vDirectives.test(name);\n\n            if(validName && vBindValue.test(value)) {\n                properties.push(value);\n            }\n        }\n\n        // Add parent properties\n\n        properties.forEach(prop => {\n            properties = _.union(properties, paths.parents(prop));\n        })\n\n        return _(properties).uniq().sort();\n    }\n\n    function loadSyncedPropertiesMapping(attrs) {\n\n        // autodetect simple binding on props detect \n\n        const vModel      = /^(?:v-model)$/i;\n        const vBind       = /^(?:v-bind)?:([a-z\\-]+)\\.sync*$/i;\n        const vBindValue  = /^[a-z\\$_][a-z0-9\\$_]*(\\.[a-z\\$_][a-z0-9\\$_]*)*$/i;\n\n        const mapping = {};\n        const attributes = remapAttributes(attrs);\n\n        for(const name in attributes) {\n            const value = attributes[name];\n\n            if(vModel.test(name)) {\n\n                const vueProp = 'value';\n\n                if(!vBindValue.test(value)) \n                    throw Error(`Unsupported v-model binding value: ${value}`);\n\n                    mapping[vueProp] = value;\n            }\n\n            if(vBind.test(name)) {\n\n                const vueProp = name.replace(vBind, \"$1\") // Keep only property name\n                                    .replace(/-[a-z]/g, (m)=>m[1].toUpperCase()).replace(/^[A-Z]/, (m)=>m[1].toLowerCase()) // convert to camel-case\n\n                if(!vBindValue.test(value)) \n                    throw Error(`Unsupported v-bind:${vueProp}.sync binding value: ${value}`);\n\n                    mapping[vueProp] = value;\n            }\n        }\n\n        return mapping;\n    }            \n\n    function loadExposedDelegates(attrs) {\n\n        const ngVueDeclaredRe = /^&([a-z\\$_][a-z0-9\\$_]*)$/i;\n        const ngDelegates     = (attrs.vueExpose??\"\")\n            .split(',')\n            .map(o=>o.trim())\n            .filter(o=>ngVueDeclaredRe.test(o))\n            .map(o=>o.replace(ngVueDeclaredRe,\"$1\"));\n\n        // autodetect simple delegate call with empty ()\n        // eg: call_function()\n\n        const vOnRe         = /^(?:v-on:|@)[a-z\\-]+(\\:[a-z0-9-]+)?(\\.[a-z0-9-]+)*/i;\n        const vOnDelegateRe = /^([a-z_$][a-z0-9_$]*)(?:\\(\\))?$/i;\n\n        for(var key in attrs.$attr) {\n            const name  = attrs.$attr[key];\n            const value = attrs[key];\n\n            const validName = vOnRe.test(name)\n\n            if(validName && vOnDelegateRe.test(value)) {\n                ngDelegates.push(value.replace(vOnDelegateRe, \"$1\"));\n            }\n        }\n\n        return ngDelegates;\n    }\n\n\n    function remapAttributes(attrs) {\n\n        const attributes = {}\n\n        for(var key in attrs.$attr) {\n            const name  = attrs.$attr[key];\n            const value = attrs[key];\n\n\n            attributes[name] = value;\n        }\n\n        return attributes;\n\n    }\n\n    function testDefined(scope, expression) {\n        if(scope.$eval(expression)===undefined) {\n            throw Error(`\"${expression}\" is not defined on parent scope`);\n        }\n    }\n\n}])};","import angular from \"angular\";\nimport vueDirective from \"./directives/vue\";\n\nvar ngModule = angular.module(\"angularVue\",[]);\n\nvueDirective.register(ngModule);\n"],"names":["parent","parents","leaf","root","isRoot","path","parts","split","pop","combine","parentPaths","push","length","Error","join","register","ngModule","directive","restrict","terminal","priority","link","scope","element","attrs","ngDelegates","loadExposedDelegates","ngProperties","loadExposedProperties","syncedPropertiesMapping","loadSyncedPropertiesMapping","forEach","prop","testDefined","vueData","filter","paths","reduce","data","ngProp","vueProp","$eval","vueMethods","methods","ngDelegate","console","log","$apply","apply","arguments","vm","Vue","components","$vueComponents","$mount","$watch","value","target","_","get","set","$children","c","$on","vDirectives","vBind","vBindValue","properties","vueExpose","map","o","trim","test","attributes","remapAttributes","name","validName","union","uniq","sort","vModel","mapping","replace","m","toUpperCase","toLowerCase","ngVueDeclaredRe","vOnRe","vOnDelegateRe","key","$attr","expression","undefined","angular","module","vueDirective"],"mappings":"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"}